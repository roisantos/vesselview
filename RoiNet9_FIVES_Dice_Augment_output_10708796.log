slurmstepd: info: Setting TMPDIR to /scratch/10708796. Previous errors about TMPDIR can be discarded
Restormer model not found. Restormer preprocessing will be disabled.
Available Models: ['FRNet', 'FRNet_1ch', 'FRNetR', 'RoiNet11', 'RoiNet9', 'RoiNet7', 'RoiNet5', 'RoiNet3', 'RoiNetR', 'RoiNetx1.5', 'RoiNetx0.5', 'RoiNetx2']
Datasets_library: {'FIVES512': {'paths': {'train': 'dataset/FIVES512/train', 'val': 'dataset/FIVES512/val', 'test': 'dataset/FIVES512/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVESc': {'paths': {'train': 'dataset/FIVESc/train', 'val': 'dataset/FIVESc/val', 'test': 'dataset/FIVESc/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVES': {'paths': {'train': 'dataset/FIVES/train', 'val': 'dataset/FIVES/val', 'test': 'dataset/FIVES/test'}, 'preprocessing': {'start': 0, 'end': 1}}}
USING CHANNELS = 3
Available Datasets: ['FIVES512', 'FIVESc', 'FIVES']

All datasets: {'FIVES512': {'train': <ds.dataset.SegmentationDataset object at 0x152835f88670>, 'val': <ds.dataset.SegmentationDataset object at 0x152923e7adf0>, 'test': <ds.dataset.SegmentationDataset object at 0x152923e7aee0>}, 'FIVESc': {'train': <ds.dataset.SegmentationDataset object at 0x152835f7bfd0>, 'val': <ds.dataset.SegmentationDataset object at 0x152835f7bee0>, 'test': <ds.dataset.SegmentationDataset object at 0x152835f7bdf0>}, 'FIVES': {'train': <ds.dataset.SegmentationDataset object at 0x152835f7be50>, 'val': <ds.dataset.SegmentationDataset object at 0x152835f7bd60>, 'test': <ds.dataset.SegmentationDataset object at 0x152835f7bc70>}}
Dataset a usar: {'train': <ds.dataset.SegmentationDataset object at 0x152835f7be50>, 'val': <ds.dataset.SegmentationDataset object at 0x152835f7bd60>, 'test': <ds.dataset.SegmentationDataset object at 0x152835f7bc70>}
Configuración de Entrenamiento:
  Model: RoiNet9
  Dataset: FIVES
  Config File: code/config/config.json
  Epochs: 300
  Early Stopping: 100
  Thresh Value: 100
  Batch Size: 1
  Num Workers: 32
  Learning Rate: 0.0001
  Weight Decay: 0.001
  Loss Function: Dice
  Logging Enabled: True
  Output Prefix: RoiNet9_FIVES_Dice_Augment
  Augmentation Config: {'enabled': True, 'geometric': True, 'elastic': True, 'intensity_and_color': True, 'gamma': True, 'noise': True}
  Restormer Enabled: False
  Output Directory: run_benchmark_runs/RoiNet9_FIVES_Dice_Augmentresult_2025-02-22_10-51-33
Parameters logged to: run_benchmark_runs/RoiNet9_FIVES_Dice_Augmentresult_2025-02-22_10-51-33/parameters_FIVES_RoiNet9_Dice_True_False.log

Modelo cargado en GPU:
- Parámetros totales: 30720070
- Memoria ocupada por modelo en GPU: 117.19 MB

==== Memoria GPU - Después de cargar el modelo en GPU ====
GPU 0 - Total: 40442.4 MB | Allocated: 118.2 MB | Cached: 144.0 MB


USING: Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 118.2 MB | Cached: 144.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 472.9 MB | Cached: 31766.0 MB

Validation Dice: 0.22775016008568816 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 472.9 MB | Cached: 31766.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 472.9 MB | Cached: 2796.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32056.0 MB

Validation Dice: 0.37789676815154566 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32056.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 4110.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32030.0 MB

Validation Dice: 0.45520885573792846 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32030.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 4900.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32048.0 MB

Validation Dice: 0.32520742431566113 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.3228350643540448 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.39507046744277086 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.33101823086949056 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.37236653415219545 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.4023677815613252 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.36991451103498907 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.32948272222354336 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.3107979362894505 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.5175715477281886 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.33464364399299973 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.4096698491557922 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.3605328709406905 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.38251986205901195 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.4728151774970609 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.5104530899336329 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.3551805909232687 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.5928676871400699 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.5178409733019057 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.3868391564828386 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.4180395848177882 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.3949902401620508 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.4534879163301895 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.38243372621272964 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 32050.0 MB

Validation Dice: 0.44581884914762876 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.6 MB | Cached: 5690.0 MB

