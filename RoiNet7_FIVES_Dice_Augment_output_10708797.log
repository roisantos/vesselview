slurmstepd: info: Setting TMPDIR to /scratch/10708797. Previous errors about TMPDIR can be discarded
Restormer model not found. Restormer preprocessing will be disabled.
Available Models: ['FRNet', 'FRNet_1ch', 'FRNetR', 'RoiNet11', 'RoiNet9', 'RoiNet7', 'RoiNet5', 'RoiNet3', 'RoiNetR', 'RoiNetx1.5', 'RoiNetx0.5', 'RoiNetx2']
Datasets_library: {'FIVES512': {'paths': {'train': 'dataset/FIVES512/train', 'val': 'dataset/FIVES512/val', 'test': 'dataset/FIVES512/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVESc': {'paths': {'train': 'dataset/FIVESc/train', 'val': 'dataset/FIVESc/val', 'test': 'dataset/FIVESc/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVES': {'paths': {'train': 'dataset/FIVES/train', 'val': 'dataset/FIVES/val', 'test': 'dataset/FIVES/test'}, 'preprocessing': {'start': 0, 'end': 1}}}
USING CHANNELS = 3
Available Datasets: ['FIVES512', 'FIVESc', 'FIVES']

All datasets: {'FIVES512': {'train': <ds.dataset.SegmentationDataset object at 0x145870d1f6a0>, 'val': <ds.dataset.SegmentationDataset object at 0x14595ec11df0>, 'test': <ds.dataset.SegmentationDataset object at 0x14595ec11ee0>}, 'FIVESc': {'train': <ds.dataset.SegmentationDataset object at 0x145870d12ee0>, 'val': <ds.dataset.SegmentationDataset object at 0x145870d12f40>, 'test': <ds.dataset.SegmentationDataset object at 0x145870d12e50>}, 'FIVES': {'train': <ds.dataset.SegmentationDataset object at 0x145870d12d60>, 'val': <ds.dataset.SegmentationDataset object at 0x145870d12dc0>, 'test': <ds.dataset.SegmentationDataset object at 0x145870d12cd0>}}
Dataset a usar: {'train': <ds.dataset.SegmentationDataset object at 0x145870d12d60>, 'val': <ds.dataset.SegmentationDataset object at 0x145870d12dc0>, 'test': <ds.dataset.SegmentationDataset object at 0x145870d12cd0>}
Configuración de Entrenamiento:
  Model: RoiNet7
  Dataset: FIVES
  Config File: code/config/config.json
  Epochs: 300
  Early Stopping: 100
  Thresh Value: 100
  Batch Size: 1
  Num Workers: 32
  Learning Rate: 0.0001
  Weight Decay: 0.001
  Loss Function: Dice
  Logging Enabled: True
  Output Prefix: RoiNet7_FIVES_Dice_Augment
  Augmentation Config: {'enabled': True, 'geometric': True, 'elastic': True, 'intensity_and_color': True, 'gamma': True, 'noise': True}
  Restormer Enabled: False
  Output Directory: run_benchmark_runs/RoiNet7_FIVES_Dice_Augmentresult_2025-02-22_10-51-33
Parameters logged to: run_benchmark_runs/RoiNet7_FIVES_Dice_Augmentresult_2025-02-22_10-51-33/parameters_FIVES_RoiNet7_Dice_True_False.log

Modelo cargado en GPU:
- Parámetros totales: 19149894
- Memoria ocupada por modelo en GPU: 73.05 MB

==== Memoria GPU - Después de cargar el modelo en GPU ====
GPU 0 - Total: 40442.4 MB | Allocated: 73.1 MB | Cached: 88.0 MB


USING: Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 73.1 MB | Cached: 88.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 31600.0 MB

Validation Dice: 0.34233367950066446 for Model: RoiNet7_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 31600.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 1858.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32024.0 MB

Validation Dice: 0.45997058905483323 for Model: RoiNet7_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32024.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.30332391054501695 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.41997648981182345 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.31797510948739144 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.44312640230813316 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.5123707492931544 for Model: RoiNet7_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.32643952548140737 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.332911527943561 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.4314555177428327 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.4258349809143084 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.2640833821771495 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.4340558366805667 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.3257774586952414 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.3408271605170954 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.3868078586899753 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.5117410743381687 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.458017227661639 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.4463849122295436 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.5145693427798145 for Model: RoiNet7_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.5574483825294503 for Model: RoiNet7_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.4542130209273085 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.3953526204304636 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.41849431216005467 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.35579320883195625 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.4689544833671156 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.5156463138880263 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.41361334404895694 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.4328668097906003 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.4946412950528388 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.4685183608886631 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.4677920135926547 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.4802698485225361 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.41215931089872876 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.5963141688256411 for Model: RoiNet7_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 32204.0 MB

Validation Dice: 0.5439258669673772 for Model: RoiNet7_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 292.6 MB | Cached: 2548.0 MB

