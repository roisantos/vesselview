slurmstepd: info: Setting TMPDIR to /scratch/10708822. Previous errors about TMPDIR can be discarded
Restormer model not found. Restormer preprocessing will be disabled.
Available Models: ['FRNet', 'FRNet_1ch', 'FRNetR', 'RoiNet11', 'RoiNet9', 'RoiNet7', 'RoiNet5', 'RoiNet3', 'RoiNetR', 'RoiNetx1.5', 'RoiNetx0.5', 'RoiNetx2']
Datasets_library: {'FIVES512': {'paths': {'train': 'dataset/FIVES512/train', 'val': 'dataset/FIVES512/val', 'test': 'dataset/FIVES512/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVESc': {'paths': {'train': 'dataset/FIVESc/train', 'val': 'dataset/FIVESc/val', 'test': 'dataset/FIVESc/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVES': {'paths': {'train': 'dataset/FIVES/train', 'val': 'dataset/FIVES/val', 'test': 'dataset/FIVES/test'}, 'preprocessing': {'start': 0, 'end': 1}}}
USING CHANNELS = 3
Available Datasets: ['FIVES512', 'FIVESc', 'FIVES']

All datasets: {'FIVES512': {'train': <ds.dataset.SegmentationDataset object at 0x14c5fa00e640>, 'val': <ds.dataset.SegmentationDataset object at 0x14c6e7f00df0>, 'test': <ds.dataset.SegmentationDataset object at 0x14c6e7f00ee0>}, 'FIVESc': {'train': <ds.dataset.SegmentationDataset object at 0x14c5fa001fa0>, 'val': <ds.dataset.SegmentationDataset object at 0x14c5fa001eb0>, 'test': <ds.dataset.SegmentationDataset object at 0x14c5fa001dc0>}, 'FIVES': {'train': <ds.dataset.SegmentationDataset object at 0x14c5fa001e20>, 'val': <ds.dataset.SegmentationDataset object at 0x14c5fa001d30>, 'test': <ds.dataset.SegmentationDataset object at 0x14c5fa001c40>}}
Dataset a usar: {'train': <ds.dataset.SegmentationDataset object at 0x14c5fa001e20>, 'val': <ds.dataset.SegmentationDataset object at 0x14c5fa001d30>, 'test': <ds.dataset.SegmentationDataset object at 0x14c5fa001c40>}
Configuración de Entrenamiento:
  Model: RoiNet5
  Dataset: FIVES
  Config File: code/config/config.json
  Epochs: 300
  Early Stopping: 100
  Thresh Value: 100
  Batch Size: 1
  Num Workers: 32
  Learning Rate: 0.0001
  Weight Decay: 0.001
  Loss Function: Dice
  Logging Enabled: True
  Output Prefix: RoiNet5_FIVES_Dice_Augment
  Augmentation Config: {'enabled': True, 'geometric': True, 'elastic': True, 'intensity_and_color': True, 'gamma': True, 'noise': True}
  Restormer Enabled: False
  Output Directory: run_benchmark_runs/RoiNet5_FIVES_Dice_Augmentresult_2025-02-22_10-52-44
Parameters logged to: run_benchmark_runs/RoiNet5_FIVES_Dice_Augmentresult_2025-02-22_10-52-44/parameters_FIVES_RoiNet5_Dice_True_False.log

Modelo cargado en GPU:
- Parámetros totales: 10472262
- Memoria ocupada por modelo en GPU: 39.95 MB

==== Memoria GPU - Después de cargar el modelo en GPU ====
GPU 0 - Total: 40442.4 MB | Allocated: 40.0 MB | Cached: 44.0 MB


USING: Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 40.0 MB | Cached: 44.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31472.0 MB

Validation Dice: 0.3995997006822598 for Model: RoiNet5_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31472.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.4483541762980335 for Model: RoiNet5_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.3988249476596949 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.3210936835002613 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.48081887351412533 for Model: RoiNet5_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.3703889023964514 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.4579456754546706 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.4284423356216917 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.42985697187510513 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.39933626293182983 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.3074433164556018 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.39870549820500883 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5121102907871118 for Model: RoiNet5_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.3745901036202662 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.48544477523977403 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.4607724103861189 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5198345377661422 for Model: RoiNet5_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.4061915234548454 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.4065645449291159 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5459321756071193 for Model: RoiNet5_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5142644866190998 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.40192331646507345 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5008578057928533 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.40955982027779747 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.4935287032864077 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5119821249243552 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.4937029301047089 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.3870823717649189 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5187859102018318 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.47387589977843614 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5005403645070946 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5546133749132376 for Model: RoiNet5_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5154074519079858 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5531869530740245 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.4172854312976819 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.6167886514906934 for Model: RoiNet5_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5631021103034776 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5802350303299276 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.583702912684582 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5580874107079504 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5456763355494115 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5283656182372675 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.6094808235502491 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5983295814499593 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.47532625057001254 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

Validation Dice: 0.5607945309183137 for Model: RoiNet5_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 1534.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 161.7 MB | Cached: 31704.0 MB

