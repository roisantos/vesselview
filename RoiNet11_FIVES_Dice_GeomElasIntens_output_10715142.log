slurmstepd: info: Setting TMPDIR to /scratch/10715142. Previous errors about TMPDIR can be discarded
Restormer model not found. Restormer preprocessing will be disabled.
Available Models: ['FRNet', 'FRNet_1ch', 'FRNetR', 'RoiNet11', 'RoiNet9', 'RoiNet7', 'RoiNet5', 'RoiNet3', 'RoiNetR', 'RoiNetx1.5', 'RoiNetx0.5', 'RoiNetx2']
Datasets_library: {'FIVES512': {'paths': {'train': 'dataset/FIVES512/train', 'val': 'dataset/FIVES512/val', 'test': 'dataset/FIVES512/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVESc': {'paths': {'train': 'dataset/FIVESc/train', 'val': 'dataset/FIVESc/val', 'test': 'dataset/FIVESc/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVES': {'paths': {'train': 'dataset/FIVES/train', 'val': 'dataset/FIVES/val', 'test': 'dataset/FIVES/test'}, 'preprocessing': {'start': 0, 'end': 1}}}
USING CHANNELS = 3
Available Datasets: ['FIVES512', 'FIVESc', 'FIVES']

All datasets: {'FIVES512': {'train': <ds.dataset.SegmentationDataset object at 0x15241367e670>, 'val': <ds.dataset.SegmentationDataset object at 0x152501570df0>, 'test': <ds.dataset.SegmentationDataset object at 0x152501570ee0>}, 'FIVESc': {'train': <ds.dataset.SegmentationDataset object at 0x152413672fd0>, 'val': <ds.dataset.SegmentationDataset object at 0x152413672ee0>, 'test': <ds.dataset.SegmentationDataset object at 0x152413672df0>}, 'FIVES': {'train': <ds.dataset.SegmentationDataset object at 0x152413672e50>, 'val': <ds.dataset.SegmentationDataset object at 0x152413672d60>, 'test': <ds.dataset.SegmentationDataset object at 0x152413672c70>}}
Dataset a usar: {'train': <ds.dataset.SegmentationDataset object at 0x152413672e50>, 'val': <ds.dataset.SegmentationDataset object at 0x152413672d60>, 'test': <ds.dataset.SegmentationDataset object at 0x152413672c70>}
Configuración de Entrenamiento:
  Model: RoiNet11
  Dataset: FIVES
  Config File: code/config/config.json
  Epochs: 300
  Early Stopping: 100
  Thresh Value: 100
  Batch Size: 1
  Num Workers: 32
  Learning Rate: 0.0001
  Weight Decay: 0.001
  Loss Function: Dice
  Logging Enabled: True
  Output Prefix: RoiNet11_FIVES_Dice_GeomElasIntens
  Augmentation Config: {'enabled': True, 'geometric': True, 'elastic': True, 'intensity_and_color': True, 'gamma': False, 'noise': False}
  Restormer Enabled: False
  Output Directory: run_benchmark_runs/RoiNet11_FIVES_Dice_GeomElasIntensresult_2025-02-22_17-49-14
Parameters logged to: run_benchmark_runs/RoiNet11_FIVES_Dice_GeomElasIntensresult_2025-02-22_17-49-14/parameters_FIVES_RoiNet11_Dice_True_False.log

Modelo cargado en GPU:
- Parámetros totales: 45182790
- Memoria ocupada por modelo en GPU: 172.36 MB

==== Memoria GPU - Después de cargar el modelo en GPU ====
GPU 0 - Total: 40442.4 MB | Allocated: 172.8 MB | Cached: 192.0 MB


USING: Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 172.8 MB | Cached: 192.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 31872.0 MB

Validation Dice: 0.7312260640427707 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 31872.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5970.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.6 MB | Cached: 32386.0 MB

Validation Dice: 0.7117527610429275 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.6 MB | Cached: 5570.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.7 MB | Cached: 32516.0 MB

Validation Dice: 0.7361998766011294 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.7 MB | Cached: 32516.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.7 MB | Cached: 4786.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32220.0 MB

Validation Dice: 0.7070467655826088 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 4892.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32326.0 MB

Validation Dice: 0.7192865219310327 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5148.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32348.0 MB

Validation Dice: 0.7706184128174712 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32348.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.779215391783896 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.720691990596355 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7586773108712144 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.582197412471169 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7194324709501847 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7143487954711901 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7545662118248327 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7798909686635139 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7943072229061929 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.6850853384192758 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.6886686303007844 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7814304174696215 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.80585986328636 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7257692138736267 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7914915331073585 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7706243601928847 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.6900595148718414 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7393341642796257 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7407499152933698 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7942755555406478 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7530781136342704 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7928811141105879 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.75695043140624 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7405685898268017 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7759115504201582 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7354262880357655 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7787732761824403 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.8040788265020076 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7861542135034566 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.807183217619833 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7380702169880362 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7771327526812738 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7513214256668411 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7792390434644354 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7744789532359141 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.793868367380821 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 32502.0 MB

Validation Dice: 0.7713203430979341 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5556.0 MB

