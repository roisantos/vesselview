slurmstepd: info: Setting TMPDIR to /scratch/10720040. Previous errors about TMPDIR can be discarded
Restormer model not found. Restormer preprocessing will be disabled.
Available Models: ['FRNet', 'FRNet_1ch', 'FRNetR', 'RoiNet11', 'RoiNet9', 'RoiNet7', 'RoiNet5', 'RoiNet3', 'RoiNetR', 'RoiNetx1.5', 'RoiNetx0.5', 'RoiNetx2']
Datasets_library: {'FIVES512': {'paths': {'train': 'dataset/FIVES512/train', 'val': 'dataset/FIVES512/val', 'test': 'dataset/FIVES512/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVESgan': {'paths': {'train': 'dataset/FIVESgan/train', 'val': 'dataset/FIVESgan/val', 'test': 'dataset/FIVESgan/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVESc': {'paths': {'train': 'dataset/FIVESc/train', 'val': 'dataset/FIVESc/val', 'test': 'dataset/FIVESc/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVES': {'paths': {'train': 'dataset/FIVES/train', 'val': 'dataset/FIVES/val', 'test': 'dataset/FIVES/test'}, 'preprocessing': {'start': 0, 'end': 1}}}
USING CHANNELS = 3
Available Datasets: ['FIVES512', 'FIVESgan', 'FIVESc', 'FIVES']

All datasets: {'FIVES512': {'train': <ds.dataset.SegmentationDataset object at 0x14f3fd907670>, 'val': <ds.dataset.SegmentationDataset object at 0x14f4eb7f9df0>, 'test': <ds.dataset.SegmentationDataset object at 0x14f4eb7f9ee0>}, 'FIVESgan': {'train': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbfd0>, 'val': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbee0>, 'test': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbdf0>}, 'FIVESc': {'train': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbe50>, 'val': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbd60>, 'test': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbc70>}, 'FIVES': {'train': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbcd0>, 'val': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbbe0>, 'test': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbaf0>}}
Dataset a usar: {'train': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbe50>, 'val': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbd60>, 'test': <ds.dataset.SegmentationDataset object at 0x14f3fd8fbc70>}
Configuración de Entrenamiento:
  Model: RoiNet9
  Dataset: FIVESc
  Config File: code/config/config.json
  Epochs: 300
  Early Stopping: 100
  Thresh Value: 100
  Batch Size: 1
  Num Workers: 32
  Learning Rate: 0.0001
  Weight Decay: 0.001
  Loss Function: Dice
  Logging Enabled: True
  Output Prefix: RoiNet9_FIVESc_Dice_gei_
  Augmentation Config: {'enabled': True, 'geometric': True, 'elastic': True, 'intensity_and_color': True, 'gamma': False, 'noise': False}
  Restormer Enabled: False
  Output Directory: run_benchmark_runs/RoiNet9_FIVESc_Dice_gei_result_2025-02-22_20-39-54
Parameters logged to: run_benchmark_runs/RoiNet9_FIVESc_Dice_gei_result_2025-02-22_20-39-54/parameters_FIVESc_RoiNet9_Dice_True_False.log

Modelo cargado en GPU:
- Parámetros totales: 30720070
- Memoria ocupada por modelo en GPU: 117.19 MB

==== Memoria GPU - Después de cargar el modelo en GPU ====
GPU 0 - Total: 40442.4 MB | Allocated: 118.2 MB | Cached: 144.0 MB


USING: Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 118.2 MB | Cached: 144.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 472.9 MB | Cached: 31766.0 MB

Validation Dice: 0.7561363272030283 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 472.9 MB | Cached: 31766.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 472.9 MB | Cached: 2796.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32056.0 MB

Validation Dice: 0.8091062423291523 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32056.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7919688653509299 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7733236848888547 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8123602351454106 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8018505528081502 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8408129270456809 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8323862307097697 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8194829872315782 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8315402395713354 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.782759339729245 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7946599976250419 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7881145893075889 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8015123671108045 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8091587342836419 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7744569977075881 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8348583417285056 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8341470693054267 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8351768063584892 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7925665850696972 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8201834882074854 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8021636224441065 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7925144512501467 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8235361860055322 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8346204166431981 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8208543700431616 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8273477364642522 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8561519596598541 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8127413125103201 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8376084614693582 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8474668109050102 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8044513447616618 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8442567626635488 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7390230817146254 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8377874419655202 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8453196175698566 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8134718203174681 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8107369032460237 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8422770238358179 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.851478670541267 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8189058589181434 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8266409444799075 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8503085525777123 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8419657403004156 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8500400439284549 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.849385500325178 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7389763854297018 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8464552527930918 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB

