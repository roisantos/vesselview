slurmstepd: info: Setting TMPDIR to /scratch/10720039. Previous errors about TMPDIR can be discarded
Restormer model not found. Restormer preprocessing will be disabled.
Available Models: ['FRNet', 'FRNet_1ch', 'FRNetR', 'RoiNet11', 'RoiNet9', 'RoiNet7', 'RoiNet5', 'RoiNet3', 'RoiNetR', 'RoiNetx1.5', 'RoiNetx0.5', 'RoiNetx2']
Datasets_library: {'FIVES512': {'paths': {'train': 'dataset/FIVES512/train', 'val': 'dataset/FIVES512/val', 'test': 'dataset/FIVES512/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVESgan': {'paths': {'train': 'dataset/FIVESgan/train', 'val': 'dataset/FIVESgan/val', 'test': 'dataset/FIVESgan/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVESc': {'paths': {'train': 'dataset/FIVESc/train', 'val': 'dataset/FIVESc/val', 'test': 'dataset/FIVESc/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVES': {'paths': {'train': 'dataset/FIVES/train', 'val': 'dataset/FIVES/val', 'test': 'dataset/FIVES/test'}, 'preprocessing': {'start': 0, 'end': 1}}}
USING CHANNELS = 3
Available Datasets: ['FIVES512', 'FIVESgan', 'FIVESc', 'FIVES']

All datasets: {'FIVES512': {'train': <ds.dataset.SegmentationDataset object at 0x150a9c3e26a0>, 'val': <ds.dataset.SegmentationDataset object at 0x150b8a2d4df0>, 'test': <ds.dataset.SegmentationDataset object at 0x150b8a2d4ee0>}, 'FIVESgan': {'train': <ds.dataset.SegmentationDataset object at 0x150a9c3d6ee0>, 'val': <ds.dataset.SegmentationDataset object at 0x150a9c3d6f40>, 'test': <ds.dataset.SegmentationDataset object at 0x150a9c3d6e50>}, 'FIVESc': {'train': <ds.dataset.SegmentationDataset object at 0x150a9c3d6d60>, 'val': <ds.dataset.SegmentationDataset object at 0x150a9c3d6dc0>, 'test': <ds.dataset.SegmentationDataset object at 0x150a9c3d6cd0>}, 'FIVES': {'train': <ds.dataset.SegmentationDataset object at 0x150a9c3d6be0>, 'val': <ds.dataset.SegmentationDataset object at 0x150a9c3d6c40>, 'test': <ds.dataset.SegmentationDataset object at 0x150a9c3d6b50>}}
Dataset a usar: {'train': <ds.dataset.SegmentationDataset object at 0x150a9c3d6ee0>, 'val': <ds.dataset.SegmentationDataset object at 0x150a9c3d6f40>, 'test': <ds.dataset.SegmentationDataset object at 0x150a9c3d6e50>}
Configuración de Entrenamiento:
  Model: RoiNet9
  Dataset: FIVESgan
  Config File: code/config/config.json
  Epochs: 300
  Early Stopping: 100
  Thresh Value: 100
  Batch Size: 1
  Num Workers: 32
  Learning Rate: 0.0001
  Weight Decay: 0.001
  Loss Function: Dice
  Logging Enabled: True
  Output Prefix: RoiNet9_FIVESgan_Dice_gei_
  Augmentation Config: {'enabled': True, 'geometric': True, 'elastic': True, 'intensity_and_color': True, 'gamma': False, 'noise': False}
  Restormer Enabled: False
  Output Directory: run_benchmark_runs/RoiNet9_FIVESgan_Dice_gei_result_2025-02-22_20-39-52
Parameters logged to: run_benchmark_runs/RoiNet9_FIVESgan_Dice_gei_result_2025-02-22_20-39-52/parameters_FIVESgan_RoiNet9_Dice_True_False.log

Modelo cargado en GPU:
- Parámetros totales: 30720070
- Memoria ocupada por modelo en GPU: 117.19 MB

==== Memoria GPU - Después de cargar el modelo en GPU ====
GPU 0 - Total: 40442.4 MB | Allocated: 118.2 MB | Cached: 144.0 MB


USING: Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 118.2 MB | Cached: 144.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 472.9 MB | Cached: 31766.0 MB

Validation Dice: 0.6150539429007584 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 472.9 MB | Cached: 31766.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 472.9 MB | Cached: 2796.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32056.0 MB

Validation Dice: 0.589955151651973 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7068596591435307 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.757091019392978 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7629103534958918 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7521948584788073 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7788547592509875 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7878509989089321 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8031411054616033 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7387619202727199 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7754409909694684 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7369333542527663 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7709346603710298 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.6558172936105523 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7560279273658072 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.804149965328758 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7841503287757752 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7886116560130099 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.6753807237091775 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7550672254982295 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.6959768346185672 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8244417891146039 for Model: RoiNet9_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.6392895834624336 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7775373279473144 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7245659210839842 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7702890096303696 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7925435045821971 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7836729955894537 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7064171475118253 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.807839735974519 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7800454766746269 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7852265341967214 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7820643322891317 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7618579143567374 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7063461680767925 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7963221634738583 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7310448672566662 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8140870629545717 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7757203347332621 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8104667719705513 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8035388407528731 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8044676467059885 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.7236002864412641 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 32018.0 MB

Validation Dice: 0.8040284868230804 for Model: RoiNet9_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 473.7 MB | Cached: 3320.0 MB

