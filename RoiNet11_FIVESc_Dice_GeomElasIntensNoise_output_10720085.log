slurmstepd: info: Setting TMPDIR to /scratch/10720085. Previous errors about TMPDIR can be discarded
Restormer model not found. Restormer preprocessing will be disabled.
Available Models: ['FRNet', 'FRNet_1ch', 'FRNetR', 'RoiNet11', 'RoiNet9', 'RoiNet7', 'RoiNet5', 'RoiNet3', 'RoiNetR', 'RoiNetx1.5', 'RoiNetx0.5', 'RoiNetx2']
Datasets_library: {'FIVES512': {'paths': {'train': 'dataset/FIVES512/train', 'val': 'dataset/FIVES512/val', 'test': 'dataset/FIVES512/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVESgan': {'paths': {'train': 'dataset/FIVESgan/train', 'val': 'dataset/FIVESgan/val', 'test': 'dataset/FIVESgan/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVESc': {'paths': {'train': 'dataset/FIVESc/train', 'val': 'dataset/FIVESc/val', 'test': 'dataset/FIVESc/test'}, 'preprocessing': {'start': 0, 'end': 1}}, 'FIVES': {'paths': {'train': 'dataset/FIVES/train', 'val': 'dataset/FIVES/val', 'test': 'dataset/FIVES/test'}, 'preprocessing': {'start': 0, 'end': 1}}}
USING CHANNELS = 3
Available Datasets: ['FIVES512', 'FIVESgan', 'FIVESc', 'FIVES']

All datasets: {'FIVES512': {'train': <ds.dataset.SegmentationDataset object at 0x15383eedb6a0>, 'val': <ds.dataset.SegmentationDataset object at 0x15392cdcddf0>, 'test': <ds.dataset.SegmentationDataset object at 0x15392cdcdee0>}, 'FIVESgan': {'train': <ds.dataset.SegmentationDataset object at 0x15383eed0ee0>, 'val': <ds.dataset.SegmentationDataset object at 0x15383eed0f40>, 'test': <ds.dataset.SegmentationDataset object at 0x15383eed0e50>}, 'FIVESc': {'train': <ds.dataset.SegmentationDataset object at 0x15383eed0d60>, 'val': <ds.dataset.SegmentationDataset object at 0x15383eed0dc0>, 'test': <ds.dataset.SegmentationDataset object at 0x15383eed0cd0>}, 'FIVES': {'train': <ds.dataset.SegmentationDataset object at 0x15383eed0be0>, 'val': <ds.dataset.SegmentationDataset object at 0x15383eed0c40>, 'test': <ds.dataset.SegmentationDataset object at 0x15383eed0b50>}}
Dataset a usar: {'train': <ds.dataset.SegmentationDataset object at 0x15383eed0d60>, 'val': <ds.dataset.SegmentationDataset object at 0x15383eed0dc0>, 'test': <ds.dataset.SegmentationDataset object at 0x15383eed0cd0>}
Configuración de Entrenamiento:
  Model: RoiNet11
  Dataset: FIVESc
  Config File: code/config/config.json
  Epochs: 300
  Early Stopping: 100
  Thresh Value: 100
  Batch Size: 1
  Num Workers: 32
  Learning Rate: 0.0001
  Weight Decay: 0.001
  Loss Function: Dice
  Logging Enabled: True
  Output Prefix: RoiNet11_FIVESc_Dice_gei_
  Augmentation Config: {'enabled': True, 'geometric': True, 'elastic': True, 'intensity_and_color': True, 'gamma': False, 'noise': False}
  Restormer Enabled: False
  Output Directory: run_benchmark_runs/RoiNet11_FIVESc_Dice_gei_result_2025-02-22_20-42-13
Parameters logged to: run_benchmark_runs/RoiNet11_FIVESc_Dice_gei_result_2025-02-22_20-42-13/parameters_FIVESc_RoiNet11_Dice_True_False.log

Modelo cargado en GPU:
- Parámetros totales: 45182790
- Memoria ocupada por modelo en GPU: 172.36 MB

==== Memoria GPU - Después de cargar el modelo en GPU ====
GPU 0 - Total: 40442.4 MB | Allocated: 172.8 MB | Cached: 192.0 MB


USING: Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 172.8 MB | Cached: 192.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 31872.0 MB

Validation Dice: 0.7928694883852628 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 31872.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.6 MB | Cached: 5970.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.6 MB | Cached: 32386.0 MB

Validation Dice: 0.7444030645222105 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.6 MB | Cached: 5570.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.6 MB | Cached: 32516.0 MB

Validation Dice: 0.5468036488727599 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.6 MB | Cached: 5056.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.6 MB | Cached: 32256.0 MB

Validation Dice: 0.7956093176877216 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.6 MB | Cached: 32256.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.6 MB | Cached: 4914.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32348.0 MB

Validation Dice: 0.7921557891909313 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 4634.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.3 MB | Cached: 32220.0 MB

Validation Dice: 0.8068000925280147 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.3 MB | Cached: 32220.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 692.3 MB | Cached: 5420.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32340.0 MB

Validation Dice: 0.7843140912849523 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 4906.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32334.0 MB

Validation Dice: 0.8051770562747826 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8051651347921556 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8360636783990069 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.7897840017232779 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.7918462803467823 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.7690809475972553 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8193900163587655 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8312028862057173 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8084525220898047 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8413050813333933 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.7304421157050817 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8433677112414764 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8094219513497578 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8427138435627661 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.7497068396418591 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8445713107582061 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.7144277601888238 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8440128288678428 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8426723232483354 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.840206757662242 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8463389014446783 for Model: RoiNet11_Dice
New best dice found, evaluating on test set...

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8327187171800864 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8339576107942502 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8396660883979031 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB


==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 32364.0 MB

Validation Dice: 0.8142322371514905 for Model: RoiNet11_Dice

==== Memoria GPU - Inicio de época ====
GPU 0 - Total: 40442.4 MB | Allocated: 693.2 MB | Cached: 5706.0 MB

